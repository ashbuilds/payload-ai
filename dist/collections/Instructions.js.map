{"version":3,"sources":["../../src/collections/Instructions.ts"],"sourcesContent":["import type { CollectionConfig, GroupField } from 'payload'\n\nimport { GenerationModels } from '../ai/models/index.js'\nimport { PromptTextareaField } from '../fields/PromptTextareaField/TextareaField.js'\nimport { SelectField } from '../fields/SelectField/SelectField.js'\n\nconst groupSettings = GenerationModels.reduce((fields, model) => {\n  if (model.settings) {\n    fields.push(model.settings)\n  }\n  return fields\n}, [] as GroupField[])\n\nconst modelOptions = GenerationModels.map((model) => {\n  return {\n    fields: model.fields,\n    label: model.name,\n    value: model.id,\n  }\n})\n\nexport const Instructions: CollectionConfig = {\n  slug: 'instructions',\n  access: {\n    create: () => true,\n    read: () => true,\n    update: () => true,\n  },\n  fields: [\n    {\n      name: 'schema-path',\n      type: 'text',\n      admin: {\n        readOnly: true,\n      },\n      unique: true,\n    },\n    {\n      name: 'field-type',\n      type: 'select',\n      admin: {\n        readOnly: true,\n      },\n      defaultValue: 'text',\n      label: 'Field type',\n      options: [\n        {\n          label: 'text',\n          value: 'text',\n        },\n        {\n          label: 'textarea',\n          value: 'textarea',\n        },\n        {\n          label: 'upload',\n          value: 'upload',\n        },\n        {\n          label: 'richText',\n          value: 'richText',\n        },\n      ],\n    },\n    {\n      name: 'model-id',\n      type: 'select',\n      admin: {\n        components: {\n          Field: SelectField,\n        },\n        custom: {\n          filterByField: 'field-type',\n          options: modelOptions,\n        },\n      },\n      label: 'Model',\n      options: modelOptions.map((option) => {\n        return {\n          label: option.label,\n          value: option.value,\n        }\n      }),\n      validate: () => true,\n    },\n    {\n      name: 'prompt',\n      type: 'textarea',\n      admin: {\n        components: {\n          Field: PromptTextareaField,\n        },\n      },\n    },\n    ...groupSettings,\n  ],\n  hooks: {\n    beforeChange: [\n      (req) => {\n        // console.log('req: ', req)\n        if (req.data['openai-gpt-object-settings'].layout?.length === 0) {\n          req.data['openai-gpt-object-settings'].layout = ''\n        }\n        return req.data\n      },\n    ],\n  },\n}\n"],"names":["GenerationModels","PromptTextareaField","SelectField","groupSettings","reduce","fields","model","settings","push","modelOptions","map","label","name","value","id","Instructions","slug","access","create","read","update","type","admin","readOnly","unique","defaultValue","options","components","Field","custom","filterByField","option","validate","hooks","beforeChange","req","data","layout","length"],"mappings":"AAEA,SAASA,gBAAgB,QAAQ,wBAAuB;AACxD,SAASC,mBAAmB,QAAQ,iDAAgD;AACpF,SAASC,WAAW,QAAQ,uCAAsC;AAElE,MAAMC,gBAAgBH,iBAAiBI,MAAM,CAAC,CAACC,QAAQC;IACrD,IAAIA,MAAMC,QAAQ,EAAE;QAClBF,OAAOG,IAAI,CAACF,MAAMC,QAAQ;IAC5B;IACA,OAAOF;AACT,GAAG,EAAE;AAEL,MAAMI,eAAeT,iBAAiBU,GAAG,CAAC,CAACJ;IACzC,OAAO;QACLD,QAAQC,MAAMD,MAAM;QACpBM,OAAOL,MAAMM,IAAI;QACjBC,OAAOP,MAAMQ,EAAE;IACjB;AACF;AAEA,OAAO,MAAMC,eAAiC;IAC5CC,MAAM;IACNC,QAAQ;QACNC,QAAQ,IAAM;QACdC,MAAM,IAAM;QACZC,QAAQ,IAAM;IAChB;IACAf,QAAQ;QACN;YACEO,MAAM;YACNS,MAAM;YACNC,OAAO;gBACLC,UAAU;YACZ;YACAC,QAAQ;QACV;QACA;YACEZ,MAAM;YACNS,MAAM;YACNC,OAAO;gBACLC,UAAU;YACZ;YACAE,cAAc;YACdd,OAAO;YACPe,SAAS;gBACP;oBACEf,OAAO;oBACPE,OAAO;gBACT;gBACA;oBACEF,OAAO;oBACPE,OAAO;gBACT;gBACA;oBACEF,OAAO;oBACPE,OAAO;gBACT;gBACA;oBACEF,OAAO;oBACPE,OAAO;gBACT;aACD;QACH;QACA;YACED,MAAM;YACNS,MAAM;YACNC,OAAO;gBACLK,YAAY;oBACVC,OAAO1B;gBACT;gBACA2B,QAAQ;oBACNC,eAAe;oBACfJ,SAASjB;gBACX;YACF;YACAE,OAAO;YACPe,SAASjB,aAAaC,GAAG,CAAC,CAACqB;gBACzB,OAAO;oBACLpB,OAAOoB,OAAOpB,KAAK;oBACnBE,OAAOkB,OAAOlB,KAAK;gBACrB;YACF;YACAmB,UAAU,IAAM;QAClB;QACA;YACEpB,MAAM;YACNS,MAAM;YACNC,OAAO;gBACLK,YAAY;oBACVC,OAAO3B;gBACT;YACF;QACF;WACGE;KACJ;IACD8B,OAAO;QACLC,cAAc;YACZ,CAACC;gBACC,4BAA4B;gBAC5B,IAAIA,IAAIC,IAAI,CAAC,6BAA6B,CAACC,MAAM,EAAEC,WAAW,GAAG;oBAC/DH,IAAIC,IAAI,CAAC,6BAA6B,CAACC,MAAM,GAAG;gBAClD;gBACA,OAAOF,IAAIC,IAAI;YACjB;SACD;IACH;AACF,EAAC"}