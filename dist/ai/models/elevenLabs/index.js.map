{"version":3,"sources":["../../../../src/ai/models/elevenLabs/index.ts"],"sourcesContent":["import type { File } from 'payload'\n\nimport type { GenerationConfig } from '../../../types.js'\n\nimport { SelectField } from '../../../fields/SelectField/SelectField.js'\nimport { generateFileNameByPrompt } from '../../utils/generateFileNameByPrompt.js'\nimport { generateVoice } from './generateVoice.js'\nimport { getAllVoices } from './voices.js'\n\n//TODO: Add prompt optimisation for ElevenLabs models\n\nconst { voices = [] } = await getAllVoices()\n\nconst voiceOptions = voices.map((voice) => {\n  return {\n    label: voice.name,\n    value: voice.voice_id,\n    ...voice,\n  }\n})\n\nexport const ElevenLabsConfig: GenerationConfig = {\n  models: [\n    {\n      id: 'elevenlabs/multilingual-v2',\n      name: 'ElevenLabs Multilingual v2',\n      fields: ['upload'],\n      handler: async (text: string, options) => {\n        const voiceData = await generateVoice(text, options)\n        return {\n          data: {\n            alt: 'voice over',\n          },\n          file: {\n            name: `voice_${generateFileNameByPrompt(text)}.mp3`,\n            data: voiceData.buffer,\n            mimetype: 'audio/mp3',\n            size: voiceData.buffer.byteLength,\n          } as File,\n        }\n      },\n      output: 'audio',\n      settings: {\n        name: 'elevenlabs-multilingual-v2-settings',\n        type: 'group',\n        admin: {\n          condition: (data) => {\n            return data['model-id'] === 'elevenlabs/multilingual-v2'\n          },\n        },\n        fields: [\n          {\n            name: 'voice_id',\n            type: 'select',\n            admin: {\n              components: {\n                Field: SelectField,\n              },\n              custom: {\n                options: voiceOptions,\n              },\n            },\n            defaultValue: voiceOptions[0].voice_id,\n            label: 'Voice',\n            options: voiceOptions.map((option) => {\n              return {\n                label: option.name,\n                value: option.voice_id,\n              }\n            }),\n            required: true,\n            validate: () => true,\n          },\n          {\n            type: 'collapsible',\n            admin: {\n              initCollapsed: false,\n            },\n            fields: [\n              {\n                name: 'stability',\n                type: 'number',\n                defaultValue: 0.5,\n                label: 'Stability',\n                max: 1,\n                min: 0,\n                required: true,\n              },\n              {\n                name: 'similarity_boost',\n                type: 'number',\n                defaultValue: 0.5,\n                label: 'Similarity Boost',\n                max: 1,\n                min: 0,\n                required: true,\n              },\n              {\n                name: 'style',\n                type: 'number',\n                defaultValue: 0.5,\n                label: 'Style',\n                max: 1,\n                min: 0,\n              },\n              {\n                name: 'use_speaker_boost',\n                type: 'checkbox',\n                label: 'Use Speaker Boost',\n              },\n            ],\n            label: 'Voice Settings',\n          },\n          {\n            name: 'seed',\n            type: 'number',\n            label: 'Seed',\n          },\n          {\n            type: 'row',\n            fields: [\n              {\n                name: 'previous_text',\n                type: 'textarea',\n                // admin: {\n                //   components: {\n                //     Field: PromptTextareaField,\n                //   },\n                // },\n                label: 'Previous Text',\n              },\n              {\n                name: 'next_text',\n                type: 'textarea',\n                // admin: {\n                //   components: {\n                //     Field: PromptTextareaField,\n                //   },\n                // },\n                label: 'Next Text',\n              },\n            ],\n          },\n        ],\n        label: 'ElevenLabs Multilingual v2 Settings',\n      },\n    },\n  ],\n  provider: 'ElevenLabs',\n}\n"],"names":["SelectField","generateFileNameByPrompt","generateVoice","getAllVoices","voices","voiceOptions","map","voice","label","name","value","voice_id","ElevenLabsConfig","models","id","fields","handler","text","options","voiceData","data","alt","file","buffer","mimetype","size","byteLength","output","settings","type","admin","condition","components","Field","custom","defaultValue","option","required","validate","initCollapsed","max","min","provider"],"mappings":"AAIA,SAASA,WAAW,QAAQ,6CAA4C;AACxE,SAASC,wBAAwB,QAAQ,0CAAyC;AAClF,SAASC,aAAa,QAAQ,qBAAoB;AAClD,SAASC,YAAY,QAAQ,cAAa;AAE1C,qDAAqD;AAErD,MAAM,EAAEC,SAAS,EAAE,EAAE,GAAG,MAAMD;AAE9B,MAAME,eAAeD,OAAOE,GAAG,CAAC,CAACC;IAC/B,OAAO;QACLC,OAAOD,MAAME,IAAI;QACjBC,OAAOH,MAAMI,QAAQ;QACrB,GAAGJ,KAAK;IACV;AACF;AAEA,OAAO,MAAMK,mBAAqC;IAChDC,QAAQ;QACN;YACEC,IAAI;YACJL,MAAM;YACNM,QAAQ;gBAAC;aAAS;YAClBC,SAAS,OAAOC,MAAcC;gBAC5B,MAAMC,YAAY,MAAMjB,cAAce,MAAMC;gBAC5C,OAAO;oBACLE,MAAM;wBACJC,KAAK;oBACP;oBACAC,MAAM;wBACJb,MAAM,CAAC,MAAM,EAAER,yBAAyBgB,MAAM,IAAI,CAAC;wBACnDG,MAAMD,UAAUI,MAAM;wBACtBC,UAAU;wBACVC,MAAMN,UAAUI,MAAM,CAACG,UAAU;oBACnC;gBACF;YACF;YACAC,QAAQ;YACRC,UAAU;gBACRnB,MAAM;gBACNoB,MAAM;gBACNC,OAAO;oBACLC,WAAW,CAACX;wBACV,OAAOA,IAAI,CAAC,WAAW,KAAK;oBAC9B;gBACF;gBACAL,QAAQ;oBACN;wBACEN,MAAM;wBACNoB,MAAM;wBACNC,OAAO;4BACLE,YAAY;gCACVC,OAAOjC;4BACT;4BACAkC,QAAQ;gCACNhB,SAASb;4BACX;wBACF;wBACA8B,cAAc9B,YAAY,CAAC,EAAE,CAACM,QAAQ;wBACtCH,OAAO;wBACPU,SAASb,aAAaC,GAAG,CAAC,CAAC8B;4BACzB,OAAO;gCACL5B,OAAO4B,OAAO3B,IAAI;gCAClBC,OAAO0B,OAAOzB,QAAQ;4BACxB;wBACF;wBACA0B,UAAU;wBACVC,UAAU,IAAM;oBAClB;oBACA;wBACET,MAAM;wBACNC,OAAO;4BACLS,eAAe;wBACjB;wBACAxB,QAAQ;4BACN;gCACEN,MAAM;gCACNoB,MAAM;gCACNM,cAAc;gCACd3B,OAAO;gCACPgC,KAAK;gCACLC,KAAK;gCACLJ,UAAU;4BACZ;4BACA;gCACE5B,MAAM;gCACNoB,MAAM;gCACNM,cAAc;gCACd3B,OAAO;gCACPgC,KAAK;gCACLC,KAAK;gCACLJ,UAAU;4BACZ;4BACA;gCACE5B,MAAM;gCACNoB,MAAM;gCACNM,cAAc;gCACd3B,OAAO;gCACPgC,KAAK;gCACLC,KAAK;4BACP;4BACA;gCACEhC,MAAM;gCACNoB,MAAM;gCACNrB,OAAO;4BACT;yBACD;wBACDA,OAAO;oBACT;oBACA;wBACEC,MAAM;wBACNoB,MAAM;wBACNrB,OAAO;oBACT;oBACA;wBACEqB,MAAM;wBACNd,QAAQ;4BACN;gCACEN,MAAM;gCACNoB,MAAM;gCACN,WAAW;gCACX,kBAAkB;gCAClB,kCAAkC;gCAClC,OAAO;gCACP,KAAK;gCACLrB,OAAO;4BACT;4BACA;gCACEC,MAAM;gCACNoB,MAAM;gCACN,WAAW;gCACX,kBAAkB;gCAClB,kCAAkC;gCAClC,OAAO;gCACP,KAAK;gCACLrB,OAAO;4BACT;yBACD;oBACH;iBACD;gBACDA,OAAO;YACT;QACF;KACD;IACDkC,UAAU;AACZ,EAAC"}